
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Кристалл Души</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f4f4;
      color: #333;
      text-align: center;
      padding: 20px;
    }
    .container {
      max-width: 400px;
      margin: auto;
      background-color: #ffffff;
      border-radius: 20px;
      padding: 30px 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    h1 {
      font-size: 1.8em;
      color: #6a1b9a;
      margin-bottom: 20px;
    }
    input[type="date"], button {
      padding: 10px;
      font-size: 1em;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin: 10px 0;
      width: 100%;
    }
    button {
      background-color: #6a1b9a;
      color: #fff;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    .cell {
      padding: 25px 0;
      font-weight: bold;
      font-size: 1.3em;
      border-radius: 10px;
      color: #000;
    }
    .archetype {
      margin-top: 10px;
      color: #6a1b9a;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Генератор Кристалла Души</h1>
    <input type="date" id="birthdate" />
    <button onclick="calculateCrystal()">Построить Кристалл</button>
    <div class="archetype" id="archetypeBox"></div>
    <div class="grid" id="energyGrid"></div>
  </div>

  <script>
    const archetypes = [
      'Деятель', 'Партнер', 'Профессионал', 'Организатор', 'Спасатель', 'Мастер',
      'Управленец', 'Соратник', 'Новатор', 'Наставник', 'Вдохновитель', 'Создатель'
    ];

    const energyColors = {
      1: '#fe0000', 2: '#fd9100', 3: '#ffff00',
      4: '#adff30', 5: '#158f06', 6: '#0b913d',
      7: '#0000fe', 8: '#00a7fd', 9: '#701a82',
      10: '#b28ed2', 11: '#c83d84', 12: '#ff2ebc'
    };

    function reduceTo12(num) {
      while (num > 12) {
        num = num.toString().split('').reduce((a, b) => a + +b, 0);
      }
      return num === 0 ? 12 : num;
    }

    function calculateCrystal() {
      const dateStr = document.getElementById('birthdate').value;
      if (!dateStr) return;
      const [year, month, day] = dateStr.split('-').map(Number);

      const d = reduceTo12(day);
      const m = reduceTo12(month);
      const y = reduceTo12(year.toString().split('').reduce((a, b) => a + +b, 0));

      const arr = [];
      arr[0] = d;
      arr[1] = m;
      arr[2] = y;
      arr[3] = reduceTo12(arr[0] + arr[1]);
      arr[4] = reduceTo12(arr[0] + arr[2]);
      arr[5] = reduceTo12(arr[1] + arr[2]);
      arr[6] = reduceTo12(arr[3] + arr[4]);
      arr[7] = reduceTo12(arr[3] + arr[5]);
      arr[8] = reduceTo12(arr[4] + arr[5]);
      arr[9] = reduceTo12(arr[6] + arr[7]);
      arr[10] = reduceTo12(arr[6] + arr[8]);
      arr[11] = reduceTo12(arr[7] + arr[8]);

      const archetypeNum = reduceTo12(day + month + year.toString().split('').reduce((a, b) => a + +b, 0));
      const archetype = archetypes[archetypeNum - 1];
      document.getElementById('archetypeBox').innerText = `Архетип: ${archetype} (${archetypeNum})`;

      const grid = document.getElementById('energyGrid');
      grid.innerHTML = '';
      const order = [9, 10, 11, 6, 7, 8, 3, 4, 5, 0, 1, 2];
      for (let i = 0; i < 12; i++) {
        const idx = order[i];
        const div = document.createElement('div');
        div.className = 'cell';
        div.style.backgroundColor = energyColors[arr[idx]];
        div.innerText = arr[idx];
        grid.appendChild(div);
      }
    }
  </script>
</body>
</html>
